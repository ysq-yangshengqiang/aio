# OKR数据库修复指南

## 🚨 立即修复步骤

### 1. 访问Supabase Dashboard
1. 登录您的Supabase项目
2. 前往 **SQL Editor**

### 2. 执行修复SQL
1. 复制 `database/IMMEDIATE_FIX.sql` 中的完整SQL代码
2. 粘贴到Supabase SQL Editor中
3. 点击 **Run** 执行

### 3. 验证修复结果
1. 访问调试页面：`http://localhost:3005/debug/database`
2. 按顺序执行以下测试：
   - 点击 **"测试连接"** → 应显示 ✅ 连接成功
   - 点击 **"检查OKR表"** → 应显示 ✅ 表存在，✅ 表结构完整
   - 点击 **"检查Key Results表"** → 应显示 ✅ 表存在，✅ 表结构完整
   - 填写测试标题，点击 **"测试创建OKR"** → 应显示 ✅ 创建成功

### 4. 测试完整功能
修复完成后，您应该能够：
- ✅ 访问OKR管理页面 `/okr`
- ✅ 创建新的OKR `/okr/create`
- ✅ 查看和编辑现有OKR
- ✅ 管理关键结果

## 🔍 如果仍有问题

### 检查用户认证
确保您已登录应用，RLS策略需要有效的用户ID。

### 检查Supabase项目
确认SQL在正确的Supabase项目中执行。

### 查看错误日志
在浏览器开发者工具的Console中查看详细错误信息。

## 📋 修复说明

此SQL脚本会：
1. 完全删除有问题的现有表
2. 重新创建具有完整字段的OKR和Key Results表
3. 设置正确的索引和权限策略
4. 验证表结构创建成功

⚠️ **注意**：这会删除现有的OKR数据，如果有重要数据请先备份。